<!DOCTYPE html>
<html>
<head>
    <title>Research Design and Implementation Flow</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
            max-width: 2400px;
        }
        .container {
            width: 100%;
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            padding: 35px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            min-height: 1000px;
            max-height: 1000px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: auto;
        }
        .mermaid {
            width: 100%;
            height: 100%;
            font-size: 42px;
            font-family: Arial, sans-serif;
            font-weight: 700;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            transform: scale(1);
            transform-origin: center center;
        }
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            width: 100%;
            margin-bottom: 30px;
            padding: 20px;
        }
        .logo-container img {
            height: 80px;
            object-fit: contain;
        }
        #dlcp-logo {
            height: 60px;
        }
        .title {
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 2000px;
        }
        .title h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="title">
        <h1>Research Design and Implementation Flow</h1>
    </div>

    <div class="container">
        <div class="mermaid">
        flowchart TB
            Planning["Planning Phase"]
            Planning --> DataPrep["Data Preparation"]
            Planning --> Collection["Data Collection"]
            Planning --> Analysis["Analysis"]
            Planning --> Outcomes["Outcomes"]
            Planning --> Dissemination["Dissemination"]

            subgraph Planning["Planning Phase"]
                direction TB
                A["Start<br/>Jul '24"] --> B["Instrument"]
                B --> C["STARS<br/>4 Ps"]
                C --> D["Qualtrics"]
                D --> E["Pilot<br/>n=12"]
            end
            
            subgraph DataPrep["Data Preparation"]
                direction TB
                subgraph StoreVal["Store Validation"]
                    direction LR
                    V1["DLCP List<br/>811"] --> V2["API"]
                    V2 --> V2a["Location"]
                    V2 --> V2b["Hours"]
                    V2 --> V2c["Status"]
                    V2a --> V3["Verified<br/>611"]
                end
                subgraph Power["Sample Size"]
                    direction LR
                    S1["Pop: 611"] --> S2["Parameters"]
                    S2 --> S2a["Effect: 0.3"]
                    S2 --> S2b["Alpha: 0.05"]
                    S2 --> S2c["df = 7"]
                    S2a & S2b & S2c --> S3["Power<br/>94.36%"]
                    S3 --> S4["n=384"]
                    S4 --> S5["FPC"]
                    S5 --> S6["n=236"]
                end
                StoreVal --> Power
            end
            
            subgraph Collection["Data Collection"]
                direction TB
                subgraph Field["Field Work"]
                    direction TB
                    F["Survey"] --> G["Assessment"]
                    F --> H["Quality"]
                    F --> I["R Shiny"]
                    I --> I2["Map/Calc/Filter"]
                end
                subgraph Process["Processing"]
                    direction TB
                    H --> D1["Clean"] --> J["Analysis"]
                end
                I2 --> H
            end
            
            subgraph Analysis["Analysis"]
                direction TB
                subgraph Stats["Statistical"]
                    direction LR
                    ST["Test"] --> ST1["ChiÂ²"]
                    ST --> ST2["Monte<br/>Carlo"]
                    ST --> ST3["Fisher"]
                end
                subgraph Market["Marketing"]
                    direction TB
                    ST --> LR["Regression"]
                    LR --> LR1["4 Ps"]
                    LR1 --> LR2["Price"]
                    LR1 --> LR3["Place"]
                    LR1 --> LR4["Product"]
                    LR1 --> LR5["Promo"]
                end
                ST1 & ST2 & ST3 & LR --> K["Results"]
            end
            
            subgraph Outcomes["Outcomes"]
                direction TB
                K --> L["Future<br/>Research"]
                K --> M["Policy<br/>Changes"]
            end
            
            subgraph Dissemination["Dissemination"]
                direction TB
                APHA["APHA"]
                NOTOH["NCTOH"]
                DCHealth["DC Health"]
                K --> APHA
                K --> NCTOH
                K --> DCHealth
            end

            %% Three-color pastel scheme: Light Blue, Sand, Blue (Outcomes & Dissemination)
            classDef planning fill:#90CAF9,stroke:#90CAF9,stroke-width:3px,color:#333,rx:14px,ry:14px,font-size:22px;
            classDef mainphase fill:#F4E2D8,stroke:#F4E2D8,stroke-width:3px,color:#333,rx:14px,ry:14px,font-size:22px;
            classDef bluephase fill:#90CAF9,stroke:#90CAF9,stroke-width:3px,color:#333,rx:14px,ry:14px,font-size:22px;
            classDef subnode fill:#90CAF9,stroke:#90CAF9,stroke-width:3px,color:#333,rx:14px,ry:14px,font-size:22px;

            class Planning planning;
            class DataPrep,Collection,Analysis mainphase;
            class Outcomes,Dissemination bluephase;
            class StoreVal,Power,Field,Process,Stats,Market,APHA,NOTOH,DCHealth subnode;
        </div>
    </div>

    <div class="logo-container">
        <img src="images/images_dchealthlogo.png" alt="DC Health Logo">
        <img src="images/American University-01.jpg" alt="American University Logo">
        <img id="dlcp-logo" src="images/DLCPlogo.png" alt="DLCP Logo">
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 35,
                rankSpacing: 45,
                fontSize: 38,
                padding: 15,
                defaultRenderer: 'dagre-wrapper',
                htmlLabels: true,
                width: 160,
                height: 55,
                fontFamily: 'Arial, sans-serif',
                fontWeight: 700,
                textAlign: 'center',
                diagramPadding: 30,
                subGraphPadding: 25,
                clusterPadding: 20
            }
        });
    </script>
</body>
</html>
